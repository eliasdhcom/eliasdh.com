<!--Author EliasDH Team-->
<div class="map-container">
    <header class="map-header">
        <button class="map-back-button cursor-pointer" (click)="goBack()">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
            </svg>
            {{ 'MAP.TRANSLATE2' | translate }}
        </button>
        <h1 class="map-title">{{ 'MAP.TRANSLATE1' | translate }}</h1>
        <div class="map-header-spacer"></div>
    </header>

    <div *ngIf="isLoading" class="map-loading">
        <div class="map-loading-spinner"></div>
        <p>{{ 'MAP.TRANSLATE3' | translate }}</p>
    </div>

    <div *ngIf="error" class="map-error cursor-pointer">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/>
        </svg>
        <p>{{ error }}</p>
        <button (click)="loadCustomers()">{{ 'MAP.TRANSLATE4' | translate }}</button>
    </div>

    <div id="map" class="map-leaflet" [class.map-with-sidebar]="isSidebarOpen"></div>

    <div class="map-sidebar" [class.map-sidebar-open]="isSidebarOpen">
        <div class="map-sidebar-header">
            <h2>{{ 'MAP.TRANSLATE5' | translate }}</h2>
            <button class="map-sidebar-close cursor-pointer" (click)="closeSidebar()">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                </svg>
            </button>
        </div>

        <div class="map-sidebar-content" *ngIf="selectedCustomer">
            <div class="map-sidebar-section">
                <div class="map-sidebar-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 7V3H2v18h20V7H12zM6 19H4v-2h2v2zm0-4H4v-2h2v2zm0-4H4V9h2v2zm0-4H4V5h2v2zm4 12H8v-2h2v2zm0-4H8v-2h2v2zm0-4H8V9h2v2zm0-4H8V5h2v2zm10 12h-8v-2h2v-2h-2v-2h2v-2h-2V9h8v10zm-2-8h-2v2h2v-2zm0 4h-2v2h2v-2z"/>
                    </svg>
                </div>
                <div class="map-sidebar-info">
                    <span class="map-sidebar-label">{{ 'MAP.TRANSLATE6' | translate }}</span>
                    <span class="map-sidebar-value">{{ selectedCustomer.name }}</span>
                </div>
            </div>

            <div class="map-sidebar-section">
                <div class="map-sidebar-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
                    </svg>
                </div>
                <div class="map-sidebar-info">
                    <span class="map-sidebar-label">{{ 'MAP.TRANSLATE7' | translate }}</span>
                    <span class="map-sidebar-value">{{ selectedCustomer.address }}</span>
                </div>
            </div>

            <div class="map-sidebar-section">
                <div class="map-sidebar-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/>
                    </svg>
                </div>
                <div class="map-sidebar-info">
                    <span class="map-sidebar-label">{{ 'MAP.TRANSLATE8' | translate }}</span>
                    <span class="map-sidebar-value">{{ selectedCustomer.vat }}</span>
                </div>
            </div>

            <div class="map-sidebar-section">
                <div class="map-sidebar-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"/>
                    </svg>
                </div>
                <div class="map-sidebar-info">
                    <span class="map-sidebar-label">{{ 'MAP.TRANSLATE9' | translate }}</span>
                    <span class="map-sidebar-value">{{ selectedCustomer.latitude }}, {{ selectedCustomer.longitude }}</span>
                </div>
            </div>

            <div class="map-sidebar-websites" *ngIf="selectedCustomer.websites && selectedCustomer.websites.length > 0">
                <h3>{{ 'MAP.TRANSLATE10' | translate }}</h3>
                <div class="map-sidebar-website" *ngFor="let website of selectedCustomer.websites">
                    <div class="map-sidebar-website-info">
                        <span class="map-sidebar-website-name">{{ website.name }}</span>
                        <span class="map-sidebar-website-type" [class]="'type-' + website.subscriptionType.toLowerCase()">
                            {{ website.subscriptionType }}
                        </span>
                    </div>
                    <button class="map-sidebar-website-button cursor-pointer" (click)="openWebsite(website.url)">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"/>
                        </svg>
                        {{ 'MAP.TRANSLATE11' | translate }}
                    </button>
                </div>
            </div>
        </div>
    </div>
    <app-contextmenu></app-contextmenu>
</div>